<?xml version="1.0" encoding="UTF-8"?>
<pipeline>
  <info>
    <name>dim_customer</name>
    <name_sync_with_filename>Y</name_sync_with_filename>
    <description/>
    <extended_description/>
    <pipeline_version/>
    <pipeline_type>Normal</pipeline_type>
    <parameters>
    </parameters>
    <capture_transform_performance>N</capture_transform_performance>
    <transform_performance_capturing_delay>1000</transform_performance_capturing_delay>
    <transform_performance_capturing_size_limit>100</transform_performance_capturing_size_limit>
    <created_user>-</created_user>
    <created_date>2025/07/27 02:07:34.573</created_date>
    <modified_user>-</modified_user>
    <modified_date>2025/07/27 02:07:34.573</modified_date>
  </info>
  <notepads>
  </notepads>
  <order>
    <hop>
      <from>staging_customer</from>
      <to>address</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>address</from>
      <to>store</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>store</from>
      <to>Select values</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>Select values</from>
      <to>If Null</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>If Null</from>
      <to>kolom active_label</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>kolom active_label</from>
      <to>Dimension lookup/update</to>
      <enabled>Y</enabled>
    </hop>
  </order>
  <transform>
    <name>Dimension lookup/update</name>
    <type>DimensionLookup</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <cache_size>5000</cache_size>
    <commit>100</commit>
    <connection>db_target</connection>
    <fields>
      <date>
        <from>date_active</from>
        <name/>
        <to>date_expired</to>
      </date>
      <field>
        <lookup>store_id</lookup>
        <name>store_id</name>
        <update>Insert</update>
      </field>
      <field>
        <lookup>active_label</lookup>
        <name>active_label</name>
        <update>Insert</update>
      </field>
      <field>
        <lookup>first_name</lookup>
        <name>first_name</name>
        <update>Insert</update>
      </field>
      <field>
        <lookup>last_name</lookup>
        <name>last_name</name>
        <update>Insert</update>
      </field>
      <field>
        <lookup>email</lookup>
        <name>email</name>
        <update>Update</update>
      </field>
      <field>
        <lookup>address_id</lookup>
        <name>address_id</name>
        <update>Insert</update>
      </field>
      <field>
        <lookup>active</lookup>
        <name>active</name>
        <update>Insert</update>
      </field>
      <field>
        <lookup>address</lookup>
        <name>address</name>
        <update>Insert</update>
      </field>
      <field>
        <lookup>district</lookup>
        <name>district</name>
        <update>Insert</update>
      </field>
      <field>
        <lookup>postal_code</lookup>
        <name>postal_code</name>
        <update>Insert</update>
      </field>
      <field>
        <lookup>phone</lookup>
        <name>phone</name>
        <update>Update</update>
      </field>
      <field>
        <lookup>city_id</lookup>
        <name>city_id</name>
        <update>Insert</update>
      </field>
      <field>
        <lookup>city_name</lookup>
        <name>city_name</name>
        <update>Insert</update>
      </field>
      <field>
        <lookup>country_id</lookup>
        <name>country_id</name>
        <update>Insert</update>
      </field>
      <field>
        <lookup>country_name</lookup>
        <name>country_name</name>
        <update>Insert</update>
      </field>
      <field>
        <lookup>store_address_id</lookup>
        <name>store_address_id</name>
        <update>Insert</update>
      </field>
      <field>
        <lookup>store_address</lookup>
        <name>store_address</name>
        <update>Insert</update>
      </field>
      <field>
        <lookup>store_district</lookup>
        <name>store_district</name>
        <update>Insert</update>
      </field>
      <field>
        <lookup>store_postal_code</lookup>
        <name>store_postal_code</name>
        <update>Insert</update>
      </field>
      <field>
        <lookup>store_city_id</lookup>
        <name>store_city_id</name>
        <update>Insert</update>
      </field>
      <field>
        <lookup>store_city_name</lookup>
        <name>store_city_name</name>
        <update>Insert</update>
      </field>
      <field>
        <lookup>store_country_id</lookup>
        <name>store_country_id</name>
        <update>Insert</update>
      </field>
      <field>
        <lookup>store_country_name</lookup>
        <name>store_country_name</name>
        <update>Insert</update>
      </field>
      <key>
        <lookup>source_id</lookup>
        <name>customer_id</name>
      </key>
      <return>
        <creation_method>autoinc</creation_method>
        <name>id</name>
        <rename/>
        <version>version</version>
      </return>
    </fields>
    <max_year>9999</max_year>
    <min_year>1900</min_year>
    <preload_cache>N</preload_cache>
    <schema>"public"</schema>
    <sequence/>
    <start_date_field_name/>
    <table>dim_customer</table>
    <update>Y</update>
    <useBatch>N</useBatch>
    <use_start_date_alternative>N</use_start_date_alternative>
    <attributes/>
    <GUI>
      <xloc>992</xloc>
      <yloc>48</yloc>
    </GUI>
  </transform>
  <transform>
    <name>If Null</name>
    <type>IfNull</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <fields>
      <field>
        <name>postal_code</name>
        <set_empty_string>N</set_empty_string>
        <value>TIDAK ADA</value>
      </field>
      <field>
        <name>store_postal_code</name>
        <set_empty_string>N</set_empty_string>
        <value>TIDAK ADA</value>
      </field>
    </fields>
    <selectFields>Y</selectFields>
    <selectValuesType>N</selectValuesType>
    <setEmptyStringAll>N</setEmptyStringAll>
    <valuetypes>
</valuetypes>
    <attributes/>
    <GUI>
      <xloc>672</xloc>
      <yloc>144</yloc>
    </GUI>
  </transform>
  <transform>
    <name>Select values</name>
    <type>SelectValues</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <fields>
      <meta>
        <date_format_lenient>N</date_format_lenient>
        <length>-2</length>
        <lenient_string_to_number>N</lenient_string_to_number>
        <name>active</name>
        <precision>-2</precision>
        <rename>active</rename>
        <storage_type/>
        <type>Boolean</type>
      </meta>
      <remove>
        <name>address_id_1</name>
      </remove>
      <remove>
        <name>store_id_1</name>
      </remove>
      <remove>
        <name>last_update</name>
      </remove>
      <remove>
        <name>create_date</name>
      </remove>
      <remove>
        <name>activebool</name>
      </remove>
      <select_unspecified>N</select_unspecified>
    </fields>
    <attributes/>
    <GUI>
      <xloc>544</xloc>
      <yloc>224</yloc>
    </GUI>
  </transform>
  <transform>
    <name>address</name>
    <type>DBJoin</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <cache>N</cache>
    <cache_size>0</cache_size>
    <connection>db_source</connection>
    <outer_join>Y</outer_join>
    <parameter>
      <field>
        <name>address_id</name>
        <type>Integer</type>
      </field>
    </parameter>
    <replace_vars>N</replace_vars>
    <rowlimit>0</rowlimit>
    <sql>SELECT address.address_id, address.address,address.district,address.postal_code,address.phone,address.city_id
      ,city.city as city_name,city.country_id,country.country as country_name
FROM address 
JOIN city  ON address.city_id = city.city_id
JOIN country ON city.country_id = country.country_id
WHERE address.address_id = ?</sql>
    <attributes/>
    <GUI>
      <xloc>256</xloc>
      <yloc>208</yloc>
    </GUI>
  </transform>
  <transform>
    <name>kolom active_label</name>
    <type>ValueMapper</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <field_to_use>active</field_to_use>
    <fields>
      <field>
        <source_value>0</source_value>
        <target_value>NONAKTIF</target_value>
      </field>
      <field>
        <source_value>1</source_value>
        <target_value>AKTIF</target_value>
      </field>
    </fields>
    <non_match_default>NONAKTIF</non_match_default>
    <target_field>active_label</target_field>
    <attributes/>
    <GUI>
      <xloc>720</xloc>
      <yloc>320</yloc>
    </GUI>
  </transform>
  <transform>
    <name>staging_customer</name>
    <type>TableInput</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>db_staging</connection>
    <execute_each_row>N</execute_each_row>
    <limit>0</limit>
    <sql>SELECT
  customer_id
, store_id
, first_name
, last_name
, email
, address_id
, activebool
, create_date
, last_update
, active
FROM "public".customer
</sql>
    <variables_active>N</variables_active>
    <attributes/>
    <GUI>
      <xloc>192</xloc>
      <yloc>80</yloc>
    </GUI>
  </transform>
  <transform>
    <name>store</name>
    <type>DBJoin</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <cache>N</cache>
    <cache_size>0</cache_size>
    <connection>db_source</connection>
    <outer_join>Y</outer_join>
    <parameter>
      <field>
        <name>store_id</name>
        <type>Integer</type>
      </field>
    </parameter>
    <replace_vars>N</replace_vars>
    <rowlimit>0</rowlimit>
    <sql>SELECT store.store_id
      ,address.address_id as store_address_id, address.address as store_address,address.district as store_district
      ,address.postal_code as store_postal_code,address.city_id as store_city_id
      ,city.city as store_city_name,city.country_id as store_country_id,country.country as store_country_name
FROM store
JOIN address ON store.address_id = address.address_id
JOIN city  ON address.city_id = city.city_id
JOIN country ON city.country_id = country.country_id
WHERE store.store_id = ?</sql>
    <attributes/>
    <GUI>
      <xloc>368</xloc>
      <yloc>272</yloc>
    </GUI>
  </transform>
  <transform_error_handling>
  </transform_error_handling>
  <attributes/>
</pipeline>
